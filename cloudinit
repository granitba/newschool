#cloud-config
package_update: true
package_upgrade: true
packages:
  - git
  - python3.9
  - python3.9-venv
  - python3-pip

runcmd:
  # Change to the home directory (adjust path as needed)
  - cd /home/ubuntu
  # Clone your repository (replace with your repository URL)
  - git clone git@github.com:granitba/newschool.git
  # Change directory into the cloned repository
  - cd newschool
  # Create a virtual environment named 'venv' using Python 3.9
  - python3.9 -m venv venv
  # Activate the virtual environment and upgrade pip
  - bash -c "source venv/bin/activate && pip install --upgrade pip"
  # Install all required dependencies from requirements.txt
  - bash -c "source venv/bin/activate && pip install -r req.txt"
  # Run the main_rand.py script in the background (redirect output to a log file)
  - bash -c "source venv/bin/activate && nohup python3.9 main_rand.py > /home/ubuntu/main_rand.log 2>&1 &"